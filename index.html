<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>منصة كنوز | شبكة الأصول الاستراتيجية العالمية</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- Leaflet Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap');
        
        :root { 
            --primary: #f59e0b; 
            --primary-dark: #d97706;
            --bg-dark: #020617; 
            --accent-blue: #3b82f6;
            --accent-green: #22c55e;
            --slate-border: #e2e8f0;
        }
        
        body { 
            font-family: 'Cairo', sans-serif; 
            scroll-behavior: smooth; 
            background-color: #f8fafc;
            -webkit-font-smoothing: antialiased;
        }

        .page-section { min-height: 100vh; padding-top: 5rem; }
        .hidden { display: none !important; }
        .active-section { display: block; animation: fadeIn 0.4s ease-out; }
        
        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        /* نظام القوائم البديل للبطاقات - يضمن ظهور النص كاملاً */
        .list-row {
            background: white;
            border: 1px solid var(--slate-border);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            transition: all 0.2s ease;
            width: 100%;
        }
        
        @media (min-width: 1024px) {
            .list-row {
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
                padding: 1rem 2rem;
            }
        }

        .list-row:hover {
            border-color: var(--primary);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
        }

        /* تحسين التمرير */
        .custom-scrollbar::-webkit-scrollbar { width: 4px; height: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: var(--primary); border-radius: 10px; }
        
        .admin-theme { background-color: var(--bg-dark); color: white; }
        .admin-theme .list-row {
            background: rgba(255, 255, 255, 0.03);
            border-color: rgba(255, 255, 255, 0.1);
            color: white;
        }

        #notification { 
            position: fixed; 
            bottom: 20px; 
            left: 50%; 
            transform: translateX(-50%) translateY(150px); 
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
            z-index: 10000; 
        }
        #notification.show { transform: translateX(-50%) translateY(0); }
        
        #project-map { height: 450px; width: 100%; border-radius: 1.5rem; border: 2px solid var(--slate-border); }

        /* التفاف النص التلقائي لضمان عدم الاختفاء */
        .text-wrap-safe {
            white-space: normal;
            word-break: break-word;
            overflow-wrap: break-word;
        }
    </style>
</head>
<body class="text-slate-900 overflow-x-hidden">

    <!-- شاشة التحميل -->
    <div id="loading-screen" class="fixed inset-0 bg-slate-950 z-[11000] hidden flex flex-col items-center justify-center">
        <div class="w-12 h-12 border-4 border-amber-500 border-t-transparent rounded-full animate-spin mb-4"></div>
        <p class="text-white font-bold text-sm italic">جاري تشغيل محرك كنوز الاستراتيجي...</p>
    </div>

    <!-- الإشعارات -->
    <div id="notification" class="bg-slate-900 text-white px-8 py-4 rounded-2xl shadow-2xl border border-white/10 flex items-center gap-4 min-w-[280px]">
        <div class="w-10 h-10 bg-amber-500 rounded-xl flex items-center justify-center text-slate-950">
            <i data-lucide="bell" class="w-5 h-5"></i>
        </div>
        <p id="notification-text" class="text-xs font-bold"></p>
    </div>

    <!-- القائمة العلوية الثابتة -->
    <nav class="fixed top-0 w-full z-[1000] bg-white/95 backdrop-blur-md border-b border-slate-200 px-4 lg:px-16 py-3 flex justify-between items-center shadow-sm">
        <div class="flex items-center gap-3 cursor-pointer" onclick="showPage('landing')">
            <div class="w-10 h-10 bg-amber-500 rounded-lg flex items-center justify-center text-slate-950 font-black text-xl shadow-md">ك</div>
            <div class="leading-none text-right">
                <span class="text-lg font-black text-slate-950 block tracking-tighter">كنوز <span class="text-amber-600 italic">للمؤسسات</span></span>
                <span class="text-[8px] text-slate-400 font-bold uppercase tracking-widest">Global Asset Intelligence</span>
            </div>
        </div>
        
        <div class="hidden lg:flex items-center gap-8 text-slate-600 font-bold text-[10px] uppercase">
            <button onclick="showPage('landing')" class="hover:text-amber-500 transition-colors">الرئيسية</button>
            <button onclick="showPage('ent-dash')" class="hover:text-amber-500 transition-colors">لوحة الرائد</button>
            <button id="nav-inv-btn" onclick="showPage('inv-dash')" class="hidden text-green-600">لوحة المستثمر</button>
            <button id="nav-adm-btn" onclick="showPage('dashboard')" class="hidden text-blue-600 font-black">Strategy BI</button>
            <button id="nav-msg-btn" onclick="showPage('messages')" class="hidden text-slate-400">الرسائل</button>
        </div>

        <div class="flex items-center gap-3">
            <div id="role-switcher" class="bg-slate-100 p-1 rounded-full flex gap-1 border">
                <button onclick="setRole('user')" id="role-user-btn" class="px-3 py-1.5 rounded-full text-[8px] font-black bg-white shadow-sm text-slate-900 border">رائد أعمال</button>
                <button onclick="setRole('investor')" id="role-inv-btn" class="px-3 py-1.5 rounded-full text-[8px] font-black text-slate-400">مستثمر</button>
                <button onclick="setRole('admin')" id="role-adm-btn" class="px-3 py-1.5 rounded-full text-[8px] font-black text-slate-400">إدارة</button>
            </div>
            <button class="lg:hidden p-2 bg-slate-100 rounded-xl" onclick="toggleMobileMenu()"><i data-lucide="menu" class="w-5 h-5"></i></button>
        </div>
    </nav>

    <!-- قائمة الجوال -->
    <div id="mobile-menu" class="fixed inset-0 bg-slate-950/98 z-[1500] hidden flex-col items-center justify-center text-white gap-8 font-black text-xl italic uppercase">
        <button onclick="toggleMobileMenu()" class="absolute top-6 right-6 p-4"><i data-lucide="x" class="w-10 h-10"></i></button>
        <button onclick="showPage('landing'); toggleMobileMenu()">الرئيسية</button>
        <button onclick="showPage('ent-dash'); toggleMobileMenu()">لوحة الرائد</button>
        <button id="mob-inv-btn" class="hidden text-green-500" onclick="showPage('inv-dash'); toggleMobileMenu()">لوحة المستثمر</button>
        <button id="mob-adm-btn" class="hidden text-blue-500" onclick="showPage('dashboard'); toggleMobileMenu()">Strategy BI</button>
    </div>

    <main>
        
        <!-- الرئيسية -->
        <section id="landing-page" class="page-section active-section">
            <div class="relative py-20 lg:py-32 px-6 bg-slate-950 text-white min-h-[80vh] flex items-center overflow-hidden">
                <div class="container mx-auto grid lg:grid-cols-2 gap-12 items-center relative z-10">
                    <div class="text-right space-y-8">
                        <span class="inline-block px-4 py-1 rounded-full bg-amber-500/10 border border-amber-500/20 text-amber-500 text-[10px] font-black uppercase tracking-widest">نظام الاستحواذ السيادي العالمي</span>
                        <h1 class="text-4xl lg:text-[5rem] font-black leading-[1.1] tracking-tighter text-wrap-safe">أصولك <span class="text-amber-500 italic">استراتيجية</span> رقمية</h1>
                        <p class="text-slate-400 text-lg lg:text-xl max-w-xl font-light text-wrap-safe">نظام "كنوز" يربط الأصول العملاقة بكبار المستثمرين عبر تحليلات دقيقة ومعالجة آلية للبيانات.</p>
                        <div class="flex flex-wrap gap-4">
                            <button onclick="showPage('form')" class="bg-amber-500 text-slate-950 px-10 py-4 rounded-xl font-black shadow-xl hover:scale-105 transition-all text-xs uppercase italic">ابدأ رحلة التمويل</button>
                            <button onclick="setRole('admin')" class="bg-white/5 border border-white/10 px-8 py-4 rounded-xl font-bold backdrop-blur-md text-xs italic">استعرض محرك BI</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- القطاعات بدون بطاقات (نظام أسطر) -->
            <div class="py-20 bg-white px-6">
                <div class="container mx-auto max-w-5xl">
                    <h2 class="text-3xl font-black text-slate-900 mb-12 text-center">القطاعات الاستراتيجية المشمولة</h2>
                    <div id="sectors-ref-container" class="space-y-4"></div>
                </div>
            </div>
        </section>

        <!-- لوحة الرائد -->
        <section id="ent-dash-page" class="page-section hidden py-12 px-6 text-right bg-slate-50 min-h-screen">
            <div class="container mx-auto max-w-5xl">
                <header class="mb-10">
                    <h2 class="text-4xl font-black tracking-tighter uppercase italic leading-none">بوابة <span class="text-amber-500">النمو</span></h2>
                    <p class="text-slate-400 text-[10px] font-black mt-2 italic uppercase">تتبع تقدم مشروعك ومواءمة المستثمرين لحظياً</p>
                </header>

                <div class="bg-white p-8 rounded-3xl border border-slate-200 shadow-sm mb-10 flex flex-col md:flex-row items-center gap-10">
                    <div class="relative w-40 h-40 shrink-0">
                        <svg class="w-full h-full" viewBox="0 0 100 100">
                            <circle class="text-slate-100" stroke-width="8" stroke="currentColor" fill="transparent" r="42" cx="50" cy="50" />
                            <circle class="text-amber-500 progress-ring" id="ready-progress-ent" stroke-width="8" stroke-dasharray="263.8" stroke-dashoffset="65" stroke-linecap="round" stroke="currentColor" fill="transparent" r="42" cx="50" cy="50" />
                        </svg>
                        <div class="absolute inset-0 flex flex-col items-center justify-center">
                            <span class="text-3xl font-black italic">75%</span>
                        </div>
                    </div>
                    <div class="grow text-right space-y-4">
                        <h4 class="font-black text-slate-800 text-2xl italic text-wrap-safe">مشروعك في مرحلة: مراجعة العناية الواجبة (Due Diligence)</h4>
                        <p class="text-slate-500 text-sm text-wrap-safe">تم مطابقة مشروعك مع 12 صندوق سيادي عالمي، بانتظار تحديث البيانات المالية للربع القادم.</p>
                        <div class="flex gap-4">
                            <button class="bg-slate-900 text-white px-6 py-2 rounded-lg text-[10px] font-black uppercase">تحديث البيانات</button>
                            <button class="border border-slate-200 px-6 py-2 rounded-lg text-[10px] font-black uppercase">تحميل التقرير</button>
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <h3 class="font-black text-lg mb-6 flex items-center gap-2"><i data-lucide="activity" class="text-amber-500"></i> ملخص الإحصائيات الحية</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-2xl border border-slate-100 flex items-center justify-between">
                            <span class="text-slate-400 text-[10px] font-black uppercase">مستثمرون مهتمون</span>
                            <span class="text-2xl font-black italic">18</span>
                        </div>
                        <div class="bg-white p-6 rounded-2xl border border-slate-100 flex items-center justify-between">
                            <span class="text-slate-400 text-[10px] font-black uppercase">المواءمة</span>
                            <span class="text-2xl font-black italic text-green-600">94%</span>
                        </div>
                        <div class="bg-white p-6 rounded-2xl border border-slate-100 flex items-center justify-between">
                            <span class="text-slate-400 text-[10px] font-black uppercase">الزيارات</span>
                            <span class="text-2xl font-black italic text-blue-600">2.4k</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- لوحة المستثمر (نظام الأسطر المرنة) -->
        <section id="inv-dash-page" class="page-section hidden min-h-screen admin-theme py-16 px-6 text-right">
            <div class="container mx-auto max-w-5xl">
                <header class="mb-16 flex flex-col lg:flex-row justify-between items-end gap-8">
                    <div class="space-y-2">
                        <h2 class="text-5xl font-black text-green-500 italic uppercase">عالم <span class="text-white italic">المستثمر</span></h2>
                        <p class="text-slate-500 text-[10px] font-black uppercase tracking-[0.4em] italic">إدارة المحفظة وتدفقات السيولة السيادية</p>
                    </div>
                    <div class="bg-white/5 border border-white/10 p-6 rounded-2xl flex gap-10 text-[9px] font-black italic">
                        <div><span class="text-slate-500 block mb-1">الأصول المدارة</span><span class="text-green-400 text-2xl font-black tracking-tighter">$450.8M</span></div>
                        <div class="border-r border-white/10 pr-10"><span class="text-slate-500 block mb-1">تحت المراقبة</span><span class="text-amber-400 text-2xl font-black tracking-tighter">14 كيان</span></div>
                    </div>
                </header>

                <h4 class="font-black text-2xl mb-8 flex items-center gap-4 italic"><i data-lucide="sparkles" class="text-green-400"></i> أفضل الفرص المفلترة بالذكاء الاصطناعي</h4>
                <div id="investor-match-list" class="space-y-4"></div>
            </div>
        </section>

        <!-- لوحة الإدارة Strategy BI (نظام الجداول والأسطر المرنة) -->
        <section id="dashboard-page" class="page-section hidden min-h-screen admin-theme py-16 px-6 text-right">
            <div class="container mx-auto max-w-6xl">
                <header class="flex flex-col lg:flex-row justify-between items-end mb-16 gap-8">
                    <div class="space-y-2">
                        <h2 class="text-6xl font-black text-blue-500 italic uppercase leading-none italic">Strategy <span class="text-white italic">BI</span></h2>
                        <p class="text-slate-500 text-[10px] font-black mt-3 uppercase tracking-[0.4em] italic">محطة الاستخبارات السيادية والتحكم في الأصول العملاقة</p>
                    </div>
                    <div class="flex flex-wrap gap-4">
                        <button onclick="window.print()" class="bg-white/5 border border-white/10 px-8 py-4 rounded-xl text-[8px] font-black uppercase italic italic">تصدير التقرير</button>
                        <button onclick="showPage('map')" class="bg-blue-600 px-12 py-4 rounded-xl font-black text-[10px] shadow-lg uppercase tracking-widest italic">خارطة التدفقات</button>
                    </div>
                </header>

                <!-- إحصائيات علوية بدون بطاقات -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-16">
                    <div class="bg-white/5 p-6 rounded-2xl border border-white/10 text-center">
                        <p class="text-[8px] text-slate-500 font-black uppercase mb-1 italic">الفرص النشطة</p>
                        <h3 id="stat-total" class="text-4xl font-black italic text-white">0</h3>
                    </div>
                    <div class="bg-white/5 p-6 rounded-2xl border border-white/10 text-center">
                        <p class="text-[8px] text-slate-500 font-black uppercase mb-1 italic">السيولة المطلوبة</p>
                        <h3 id="stat-total-funding" class="text-3xl font-black text-white italic tracking-tighter">$0M</h3>
                    </div>
                    <div class="bg-white/5 p-6 rounded-2xl border border-white/10 text-center">
                        <p class="text-[8px] text-slate-500 font-black uppercase mb-1 italic">متوسط الربحية</p>
                        <h3 id="stat-avg-profit" class="text-4xl font-black italic text-white">0%</h3>
                    </div>
                    <div class="bg-white/5 p-6 rounded-2xl border border-white/10 text-center">
                        <p class="text-[8px] text-slate-500 font-black uppercase mb-1 italic">نضج الفريق</p>
                        <h3 id="stat-avg-team" class="text-4xl font-black italic text-white">0/5</h3>
                    </div>
                </div>

                <!-- الفلترة -->
                <div class="bg-white/5 p-6 rounded-2xl border border-white/10 mb-8">
                    <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-6 items-end text-right text-[10px] font-black italic">
                        <div class="lg:col-span-2 space-y-2">
                            <label class="text-slate-500 uppercase tracking-widest mr-2 italic">البحث الاستراتيجي العميق</label>
                            <input type="text" id="filter-search" oninput="applyFilters()" placeholder="ابحث..." class="w-full bg-slate-900 border border-white/10 rounded-xl px-5 py-3 outline-none focus:ring-1 focus:ring-amber-500 text-white font-bold italic">
                        </div>
                        <div class="space-y-2">
                            <label class="text-slate-500 uppercase tracking-widest mr-2 italic">القطاع</label>
                            <select id="filter-sector" onchange="applyFilters()" class="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 outline-none text-white font-bold italic"></select>
                        </div>
                        <div class="space-y-2">
                            <label class="text-slate-500 uppercase tracking-widest mr-2 italic">المخاطرة</label>
                            <select id="filter-risk" onchange="applyFilters()" class="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 outline-none text-white font-bold italic">
                                <option value="all">الكل</option>
                                <option value="Low">Low Risk</option>
                                <option value="Medium">Medium Risk</option>
                                <option value="High">High Risk</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label class="text-slate-500 uppercase tracking-widest mr-2 italic">الربحية +%</label>
                            <input type="number" id="filter-profit-val" oninput="applyFilters()" class="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 outline-none text-white italic">
                        </div>
                        <div class="space-y-2">
                            <label class="text-slate-500 uppercase tracking-widest mr-2 italic">التمويل ($M)</label>
                            <input type="number" id="filter-funding-val" oninput="applyFilters()" class="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 outline-none text-white italic">
                        </div>
                    </div>
                </div>

                <!-- قائمة BI (أسطر مرنة لضمان ظهور النصوص) -->
                <div id="admin-list-container" class="space-y-4"></div>
            </div>
        </section>

        <!-- مركز الرسائل -->
        <section id="messages-page" class="page-section hidden min-h-screen bg-slate-50 py-16 px-6 text-right">
            <div class="container mx-auto max-w-5xl">
                <header class="mb-10 flex justify-between items-center">
                    <h2 class="text-3xl font-black italic tracking-tighter uppercase italic">Negotiation <span class="text-amber-500 italic">Command</span></h2>
                    <button onclick="showPage('dashboard')" class="text-slate-400 font-bold flex items-center gap-2 italic uppercase text-[10px] italic">العودة <i data-lucide="arrow-left" class="w-4 h-4 italic"></i></button>
                </header>
                <div class="flex flex-col lg:flex-row gap-8 bg-white rounded-3xl border border-slate-200 overflow-hidden min-h-[600px] shadow-sm">
                    <div class="lg:w-1/3 border-l bg-slate-50/50 p-8 space-y-6 overflow-y-auto custom-scrollbar">
                        <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-4 italic italic">غرف العمليات النشطة</p>
                        <div id="chat-list" class="space-y-3"></div>
                    </div>
                    <div class="lg:w-2/3 flex flex-col h-full bg-white relative">
                        <div id="active-chat-header" class="p-8 border-b flex items-center gap-4 shrink-0">
                            <div class="w-12 h-12 bg-amber-500 rounded-xl flex items-center justify-center font-black italic text-white text-xl shadow-md">ك</div>
                            <div><p id="chat-target-name" class="text-lg font-black italic italic">اختر كيان لبدء التفاوض</p><p class="text-[9px] text-green-500 font-black italic uppercase italic">• تشفير سيادي مفعل</p></div>
                        </div>
                        <div id="chat-messages-container" class="grow p-8 overflow-y-auto space-y-8 bg-slate-50/30 flex flex-col justify-center items-center text-slate-300">
                            <i data-lucide="message-square" class="w-16 h-16 opacity-10"></i>
                            <p class="text-lg font-black italic opacity-50 italic">حدد مشروعًا لبدء التفاوض المباشر</p>
                        </div>
                        <div class="p-8 border-t flex gap-4 bg-white items-center shrink-0">
                            <input type="text" placeholder="اكتب عرضك المالي..." class="grow bg-slate-50 border border-slate-200 rounded-xl px-6 py-4 text-sm font-bold outline-none focus:ring-1 focus:ring-amber-500 shadow-inner">
                            <button class="bg-slate-950 text-white p-4 rounded-xl shadow-lg hover:scale-110 transition-all italic"><i data-lucide="send" class="w-5 h-5 italic"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- تسجيل المشروع (4 خطوات) -->
        <section id="form-page" class="page-section hidden py-16 bg-slate-50 min-h-screen">
            <div class="container mx-auto px-6 max-w-4xl">
                <div class="flex justify-between mb-20 relative px-6">
                    <div class="absolute top-1/2 left-0 w-full h-1 bg-slate-200 -translate-y-1/2 z-0"></div>
                    <div id="step-line" class="absolute top-1/2 right-0 w-0 h-1 bg-amber-500 -translate-y-1/2 z-0 transition-all duration-700 italic"></div>
                    
                    <div class="relative z-10 flex flex-col items-center gap-3"><div class="step-dot w-10 h-10 rounded-full bg-amber-500 text-slate-950 flex items-center justify-center font-black ring-4 ring-white shadow-lg italic">1</div><span class="text-[8px] font-black uppercase text-amber-600 italic italic">ملف الكيان</span></div>
                    <div class="relative z-10 flex flex-col items-center gap-3"><div class="step-dot w-10 h-10 rounded-full bg-slate-200 text-slate-400 flex items-center justify-center font-black ring-4 ring-white italic">2</div><span class="text-[8px] font-black uppercase text-slate-400 italic italic">المالية</span></div>
                    <div class="relative z-10 flex flex-col items-center gap-3"><div class="step-dot w-10 h-10 rounded-full bg-slate-200 text-slate-400 flex items-center justify-center font-black ring-4 ring-white italic">3</div><span class="text-[8px] font-black uppercase text-slate-400 italic italic">الخطة</span></div>
                    <div class="relative z-10 flex flex-col items-center gap-3"><div class="step-dot w-10 h-10 rounded-full bg-slate-200 text-slate-400 flex items-center justify-center font-black ring-4 ring-white italic">4</div><span class="text-[8px] font-black uppercase text-slate-400 italic italic">التشخيص</span></div>
                </div>

                <div id="form-step-1" class="active-step bg-white rounded-3xl p-10 lg:p-14 shadow-sm border border-slate-200 text-right relative overflow-hidden">
                    <h2 class="text-4xl font-black mb-10 border-b border-slate-100 pb-6 italic italic text-wrap-safe">أولاً: الملف التعريفي والجيومكاني</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div class="space-y-2"><label class="text-[9px] font-black text-slate-500 uppercase italic italic">اسم المشروع</label><input type="text" id="f-name" class="w-full p-5 bg-slate-50 border border-slate-200 rounded-xl outline-none font-bold text-lg focus:ring-1 focus:ring-amber-500 shadow-inner"></div>
                        <div class="space-y-2"><label class="text-[9px] font-black text-slate-500 uppercase italic italic">القطاع الاستراتيجي</label><select id="f-sector" class="w-full p-5 bg-slate-50 border border-slate-200 rounded-xl outline-none font-bold text-lg focus:ring-1 focus:ring-amber-500 shadow-inner"></select></div>
                        <div class="space-y-2"><label class="text-[9px] font-black text-slate-500 uppercase italic italic">الدولة</label><input type="text" id="f-country" class="w-full p-5 bg-slate-50 border border-slate-200 rounded-xl outline-none font-bold text-lg shadow-inner"></div>
                        <div class="space-y-2"><label class="text-[9px] font-black text-slate-500 uppercase italic italic">المدينة</label><input type="text" id="f-city" class="w-full p-5 bg-slate-50 border border-slate-200 rounded-xl outline-none font-bold text-lg shadow-inner"></div>
                    </div>
                    <div class="flex justify-end mt-12"><button onclick="nextStep(2)" class="bg-slate-950 text-white px-14 py-4 rounded-xl font-black shadow-xl hover:scale-105 transition-all text-xs uppercase italic italic">التالي</button></div>
                </div>

                <!-- الخطوة 4 (مصفوفة التشخيص) -->
                <div id="form-step-4" class="hidden bg-white rounded-3xl p-10 lg:p-14 shadow-sm border border-slate-200 text-right">
                    <h2 class="text-4xl font-black mb-10 text-center italic italic text-wrap-safe">مصفوفة التشخيص النهائي (5/5)</h2>
                    <div id="diagnosis-questions-container" class="space-y-8 mb-12"></div>
                    <div class="flex justify-between items-center mt-10 border-t border-slate-100 pt-8">
                         <button onclick="nextStep(3)" class="text-slate-400 font-black px-8 italic uppercase text-[9px] italic">السابق</button>
                         <button onclick="submitDiagnostics()" class="bg-amber-500 text-slate-950 px-16 py-4 rounded-xl font-black shadow-xl hover:scale-105 transition-all text-lg italic uppercase italic">إرسال لـ Strategy BI</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- الخريطة -->
        <section id="map-page" class="page-section hidden py-24 admin-theme text-white min-h-screen px-8">
            <div class="container mx-auto text-center space-y-12">
                <header>
                    <h2 class="text-6xl font-black text-amber-500 italic mb-4 uppercase tracking-widest leading-none italic italic">Geospatial Asset Map</h2>
                    <p class="text-slate-500 font-bold uppercase text-[11px] tracking-[0.4em] italic italic">نظام التتبع الجغرافي للأصول المدارة</p>
                </header>
                <div id="project-map" class="shadow-2xl border border-white/5 relative z-10"></div>
            </div>
        </section>

    </main>

    <!-- المودال: تفاصيل الكيان -->
    <div id="details-modal" class="fixed inset-0 bg-slate-950/98 z-[10000] hidden items-center justify-center p-6 lg:p-12 backdrop-blur-3xl overflow-y-auto">
        <div class="bg-white rounded-[3rem] w-full max-w-6xl overflow-hidden shadow-2xl flex flex-col max-h-[95vh] text-right border border-slate-200">
            <div id="modal-view-main" class="flex flex-col h-full">
                <div class="p-8 lg:p-10 bg-amber-500 flex justify-between items-center text-slate-950 shrink-0">
                    <div>
                        <span id="modal-status-badge" class="bg-slate-950 text-white text-[9px] px-5 py-2 rounded-full font-black uppercase mb-4 inline-block italic tracking-widest italic">تحليل استراتيجي مكتمل</span>
                        <h3 id="modal-title" class="text-3xl lg:text-4xl font-black tracking-tighter italic uppercase italic">ملف الكيان التفصيلي</h3>
                    </div>
                    <button onclick="closeModal()" class="w-14 h-14 bg-slate-950/10 rounded-2xl flex items-center justify-center hover:bg-slate-950/20 transition-all">
                        <i data-lucide="x" class="w-8 h-8 italic"></i>
                    </button>
                </div>

                <div class="overflow-y-auto p-8 lg:p-12 grow space-y-12 custom-scrollbar">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-10">
                        <div class="lg:col-span-2 space-y-10">
                            <!-- تفاصيل بأسطر مرنة لضمان العرض -->
                            <div id="modal-metrics-grid" class="space-y-4"></div>
                            
                            <div class="bg-slate-50 p-8 rounded-2xl border border-slate-200">
                                <h4 class="font-black text-slate-900 text-xl flex items-center gap-4 mb-6 italic italic"><i data-lucide="file-check" class="text-amber-500 italic"></i> وثائق العناية الواجبة</h4>
                                <div class="space-y-3">
                                    <div class="p-5 bg-white border border-slate-200 rounded-xl flex justify-between items-center cursor-pointer hover:border-amber-500 transition-all group">
                                        <div class="flex items-center gap-4"><i data-lucide="file-text" class="text-blue-500 italic"></i><p class="text-[10px] font-black italic text-wrap-safe italic">تقييم_الأصول_الاستراتيجي_2025.pdf</p></div>
                                        <i data-lucide="download" class="w-4 h-4 text-slate-300 italic group-hover:text-amber-500 italic"></i>
                                    </div>
                                    <div class="p-5 bg-white border border-slate-200 rounded-xl flex justify-between items-center cursor-pointer hover:border-amber-500 transition-all group">
                                        <div class="flex items-center gap-4"><i data-lucide="shield" class="text-green-500 italic"></i><p class="text-[10px] font-black italic text-wrap-safe italic">سجل_الملكية_الفكرية_والسيادة_الرقمية.pdf</p></div>
                                        <i data-lucide="download" class="w-4 h-4 text-slate-300 italic group-hover:text-amber-500 italic"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="admin-actions-sidebar" class="hidden space-y-6">
                            <div class="bg-slate-950 text-white p-8 rounded-[2rem] border border-white/5 space-y-8 shadow-2xl">
                                <h4 class="text-amber-500 font-black text-[10px] uppercase tracking-widest italic border-b border-white/5 pb-4 italic italic">إجراءات الإدارة</h4>
                                <div class="grid grid-cols-1 gap-3">
                                    <button onclick="updateStatus('Pinned')" class="w-full p-4 bg-white/5 border border-white/10 rounded-xl hover:bg-amber-500 hover:text-slate-950 transition-all text-[9px] font-black uppercase italic italic italic">تثبيت في الواجهة <i data-lucide="pin" class="w-3 h-3 inline italic"></i></button>
                                    <button onclick="updateStatus('Rejected')" class="w-full p-4 bg-white/5 border border-red-500/30 rounded-xl text-[9px] font-black uppercase text-red-500 hover:bg-red-500 hover:text-white transition-all italic italic italic">رفض المشروع <i data-lucide="x-circle" class="w-3 h-3 inline italic"></i></button>
                                </div>
                                <button onclick="showAcquisitionRoom()" class="w-full bg-amber-500 text-slate-950 py-6 rounded-2xl font-black shadow-xl hover:scale-105 transition-all text-lg italic uppercase italic italic">غرفة المفاوضات <i data-lucide="zap" class="inline w-6 h-6 ml-2 italic"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        let userRole = 'user';
        let projects = [];
        let currentProjectId = null;
        let map, markersGroup;

        const SECTORS = [
            "الذكاء الاصطناعي والأتمتة", "الأمن السيبراني المتطور", "التقنيات المالية (FinTech)", "الخدمات اللوجستية الذكية", 
            "الطاقة المستدامة والمتجددة", "التقنيات الزراعية المتطورة", "تكنولوجيا الرعاية الصحية", "التجارة الإلكترونية العابرة للحدود",
            "تكنولوجيا التعليم الرقمي", "الاقتصاد الأخضر والمستدام", "العقارات الذكية (PropTech)", "خدمات البرمجيات السحابية",
            "تكنولوجيا الفضاء والطيران", "التقنية الحيوية (Biotech)", "تكنولوجيا الدفاع والأمن", "التصنيع المتقدم"
        ];

        const CITY_COORDS = { 
            "الرياض": [24.71, 46.67], "دبي": [25.20, 55.27], "جدة": [21.48, 39.19], 
            "القاهرة": [30.04, 31.23], "المنامة": [26.22, 50.58], "الكويت": [29.37, 47.97]
        };

        const REALISTIC_COMPANIES = [
            "سديم للحلول السحابية والبيانات الضخمة", "نماء للتقنيات الزراعية والأمن الغذائي", "شركة مآل المالية للتحويلات المشفرة", "أفق للخدمات اللوجستية وسلاسل التوريد",
            "روابي للطاقة المستدامة والرياح", "ثراء لأبحاث الذكاء والتعلم العميق", "درع للأمن السيبراني وحماية البنى", "كيان للتجارة الرقمية العالمية",
            "جسور للتعليم التفاعلي والواقع المعزز", "إيكو-لوب للاقتصاد الأخضر وإدارة النفايات", "مدار لأنظمة الفضاء والاتصال الرقمي", "أركان للتقنية العقارية والمدن الذكية",
            "إمداد لسلاسل التوريد والذكاء اللوجستي", "نبراس للتقنية الحيوية والأبحاث الجينية", "صمود للأنظمة الدفاعية والأمن الوطني", "رعاية للأنظمة الصحية والذكاء الطبي"
        ];

        function seedData() {
            projects = [];
            const cities = Object.keys(CITY_COORDS);
            for(let i=1; i<=30; i++) {
                const city = cities[i % cities.length];
                const profit = 15 + Math.floor(Math.random() * 55);
                const funding = (Math.random() * 50 + 5).toFixed(1);
                projects.push({
                    id: i, name: REALISTIC_COMPANIES[i % REALISTIC_COMPANIES.length] + " " + (i),
                    sector: SECTORS[i % SECTORS.length], city: city, country: "المملكة العربية السعودية", coords: CITY_COORDS[city],
                    profit: profit, funding: funding, risk: ["Low", "Medium", "High"][i % 3], teamRating: (Math.random()*2+3).toFixed(1),
                    status: 'نشط', alignment: (Math.random()*15+82).toFixed(1)
                });
            }
        }

        function init() {
            seedData();
            const filSector = document.getElementById('filter-sector');
            const fSector = document.getElementById('f-sector');
            if(filSector) filSector.innerHTML = '<option value="all">كافة القطاعات الاستراتيجية</option>';
            SECTORS.forEach(s => {
                const opt = document.createElement('option'); opt.value = s; opt.textContent = s;
                if(filSector) filSector.appendChild(opt.cloneNode(true));
                if(fSector) fSector.appendChild(opt);
            });

            // بناء واجهة القطاعات (قائمة طولية بدلاً من بطاقات)
            const sectorRef = document.getElementById('sectors-ref-container');
            if(sectorRef) {
                SECTORS.slice(0, 8).forEach(s => {
                    const div = document.createElement('div');
                    div.className = "p-6 bg-white border border-slate-200 rounded-2xl flex justify-between items-center group hover:border-amber-500 transition-all cursor-pointer shadow-sm";
                    div.innerHTML = `<span class="font-black text-slate-800 italic text-lg text-wrap-safe">${s}</span><i data-lucide="chevron-left" class="text-slate-300 group-hover:text-amber-500 transition-colors italic"></i>`;
                    sectorRef.appendChild(div);
                });
            }

            const qContainer = document.getElementById('diagnosis-questions-container');
            if(qContainer) {
                const SMART_QUESTIONS = [
                    { q:1, text: "المحرك الأساسي للقيمة المضافة (Unique Value)؟", opts: [{v:"A", t:"أصول فيزيائية ملموسة"}, {v:"B", t:"خوارزميات وبرمجيات فريدة"}, {v:"C", t:"بيانات ضخمة وملكيات فكرية"}] },
                    { q:2, text: "كيف يتم التعامل مع التوسع الجغرافي (Scalability)؟", opts: [{v:"A", t:"يتطلب فروعاً مادية"}, {v:"B", t:"توسع رقمي تدريجي"}, {v:"C", t:"قابل للتكرار عالمياً"}] }
                ];
                SMART_QUESTIONS.forEach(item => {
                    const div = document.createElement('div');
                    div.className = "bg-slate-50 p-8 rounded-2xl border border-slate-100";
                    div.innerHTML = `<p class="font-black text-slate-800 mb-6 italic text-xl border-r-4 border-amber-500 pr-4 italic text-wrap-safe italic">${item.text}</p><div class="space-y-3">${item.opts.map(o => `<label class="flex items-center gap-4 p-4 bg-white rounded-xl border border-slate-200 cursor-pointer hover:border-amber-500 font-black text-xs shadow-sm italic italic italic"><input type="radio" name="q${item.q}" value="${o.v}" class="w-5 h-5 accent-amber-500 italic"> ${o.t}</label>`).join('')}</div>`;
                    qContainer.appendChild(div);
                });
            }

            initMap();
            applyFilters();
            renderInvestorMatches();
            renderChatList();
            if(typeof lucide !== 'undefined') lucide.createIcons();
        }

        function showPage(id) {
            document.querySelectorAll('.page-section').forEach(p => p.classList.add('hidden'));
            const el = document.getElementById(`${id}-page`);
            if(el) { el.classList.add('active-section'); el.classList.remove('hidden'); }
            if(id === 'map' && map) setTimeout(() => map.invalidateSize(), 400);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function setRole(role) {
            userRole = role;
            ['user', 'inv', 'adm'].forEach(r => {
                const btn = document.getElementById(`role-${r}-btn`);
                if(btn) btn.className = r === role ? "px-3 py-1.5 rounded-full text-[8px] font-black bg-white shadow-md text-slate-900 border" : "px-3 py-1.5 rounded-full text-[8px] font-black text-slate-400";
            });
            document.getElementById('nav-inv-btn').classList.toggle('hidden', role !== 'investor');
            document.getElementById('nav-adm-btn').classList.toggle('hidden', role !== 'admin');
            document.getElementById('nav-msg-btn').classList.toggle('hidden', role !== 'admin');
            if(role === 'admin') showPage('dashboard'); 
            else if(role === 'investor') showPage('inv-dash'); 
            else showPage('landing');
            showNotification(`تم تغيير صلاحية الدخول بنجاح`);
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('flex');
        }

        function applyFilters() {
            const search = document.getElementById('filter-search')?.value.toLowerCase() || "";
            const sector = document.getElementById('filter-sector')?.value || "all";
            const risk = document.getElementById('filter-risk')?.value || "all";
            const profitVal = parseFloat(document.getElementById('filter-profit-val')?.value) || 0;
            const fundingVal = parseFloat(document.getElementById('filter-funding-val')?.value) || Infinity;

            const filtered = projects.filter(p => {
                const sMatch = p.name.toLowerCase().includes(search) || p.city.toLowerCase().includes(search);
                const sectorMatch = sector === 'all' || p.sector === sector;
                const riskMatch = risk === 'all' || p.risk === risk;
                const profitMatch = p.profit >= profitVal;
                const fundingMatch = parseFloat(p.funding) <= fundingVal;
                return sMatch && sectorMatch && riskMatch && profitMatch && fundingMatch;
            });

            renderAdminList(filtered);
            updateStats(filtered);
            renderMapMarkers(filtered);
        }

        // استبدال الجدول والبطاقات بنظام الأسطر المرنة (List Rows)
        function renderAdminList(data) {
            const container = document.getElementById('admin-list-container');
            if(!container) return;
            container.innerHTML = data.map(p => `
                <div class="list-row text-right">
                    <div class="grow space-y-1">
                        <div class="font-black text-white text-xl italic tracking-tighter text-wrap-safe">${p.name}</div>
                        <div class="text-[9px] text-amber-500 font-black uppercase tracking-widest">${p.sector} • ${p.city}</div>
                    </div>
                    <div class="flex flex-wrap items-center gap-8 justify-between lg:justify-end">
                        <div class="text-center"><span class="text-slate-500 text-[8px] block italic uppercase mb-1">الربحية</span><span class="text-amber-500 font-black text-2xl italic">${p.profit}%</span></div>
                        <div class="text-center"><span class="text-slate-500 text-[8px] block italic uppercase mb-1">التمويل</span><span class="text-slate-200 font-black text-xl italic tracking-tighter">$${p.funding}M</span></div>
                        <div class="text-center"><span class="text-slate-500 text-[8px] block italic uppercase mb-1">المخاطرة</span><span class="text-[9px] px-3 py-1 border border-white/10 rounded-full font-black text-white">${p.risk}</span></div>
                        <button onclick="viewProject(${p.id})" class="bg-white/10 p-4 rounded-xl text-amber-500 hover:scale-110 transition-transform"><i data-lucide="microscope" class="w-6 h-6 italic"></i></button>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
        }

        function updateStats(data) {
            const t = data.length;
            const funding = data.reduce((a, b) => a + parseFloat(b.funding), 0).toFixed(0);
            const profit = t > 0 ? (data.reduce((a, b) => a + b.profit, 0) / t).toFixed(1) : 0;
            const team = t > 0 ? (data.reduce((a, b) => a + parseFloat(b.teamRating), 0) / t).toFixed(1) : 0;
            if(document.getElementById('stat-total')) document.getElementById('stat-total').textContent = t;
            if(document.getElementById('stat-total-funding')) document.getElementById('stat-total-funding').textContent = `$${funding}M`;
            if(document.getElementById('stat-avg-profit')) document.getElementById('stat-avg-profit').textContent = `${profit}%`;
            if(document.getElementById('stat-avg-team')) document.getElementById('stat-avg-team').textContent = `${team}/5`;
        }

        function renderInvestorMatches() {
            const container = document.getElementById('investor-match-list');
            if(!container) return;
            const matches = projects.sort((a,b) => b.alignment - a.alignment).slice(0, 10);
            container.innerHTML = matches.map(p => `
                <div class="list-row items-center border-l-4 border-l-green-500">
                    <div class="grow space-y-1">
                        <div class="font-black text-white text-xl italic tracking-tighter text-wrap-safe">${p.name}</div>
                        <div class="text-[9px] text-slate-500 font-black uppercase tracking-widest">${p.sector} • ${p.city}</div>
                    </div>
                    <div class="flex items-center gap-10">
                        <div class="text-center"><span class="text-slate-500 text-[8px] block italic mb-1 uppercase">المواءمة</span><span class="text-green-500 font-black text-2xl italic">${p.alignment}%</span></div>
                        <div class="text-center"><span class="text-slate-500 text-[8px] block italic mb-1 uppercase">التمويل</span><span class="text-white font-black text-xl italic tracking-tighter">$${p.funding}M</span></div>
                        <button onclick="viewProject(${p.id})" class="bg-green-500 text-slate-950 px-8 py-3 rounded-xl font-black text-[10px] shadow-lg hover:scale-105 transition-all italic italic uppercase">تحليل</button>
                    </div>
                </div>
            `).join('');
        }

        function initMap() {
            const mapEl = document.getElementById('project-map');
            if(!mapEl || map) return;
            map = L.map('project-map').setView([24, 45], 4);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);
            markersGroup = L.layerGroup().addTo(map);
        }

        function renderMapMarkers(data) {
            if(!markersGroup) return;
            markersGroup.clearLayers();
            data.forEach(p => {
                const icon = L.divIcon({ className: 'custom-icon', html: `<div style="background:#f59e0b;width:14px;height:14px;border:2px solid white;border-radius:50%;box-shadow:0 0 10px #f59e0b"></div>`, iconSize: [14, 14] });
                if(p.coords) L.marker(p.coords, { icon: icon }).addTo(markersGroup).bindPopup(`<div class="text-right font-black italic p-2"><p class="text-amber-500 mb-2 font-black">${p.name}</p><button onclick="viewProject(${p.id})" class="w-full py-2 bg-amber-500 rounded-lg text-slate-950 text-[10px] font-black uppercase italic">تحليل BI</button></div>`);
            });
        }

        function viewProject(id) {
            currentProjectId = id;
            const p = projects.find(x => x.id == id);
            if(!p) return;
            document.getElementById('modal-title').textContent = p.name;
            document.getElementById('modal-status-badge').textContent = `حالة الكيان: ${p.status}`;
            
            // بيانات المودال كقائمة طولية لضمان عدم اختفائها
            document.getElementById('modal-metrics-grid').innerHTML = `
                <div class="p-6 bg-slate-50 border border-slate-200 rounded-2xl flex justify-between items-center"><span class="text-slate-400 font-black text-[10px] uppercase italic">الربحية الاستراتيجية</span><span class="text-amber-600 font-black text-3xl italic">${p.profit}%</span></div>
                <div class="p-6 bg-slate-50 border border-slate-200 rounded-2xl flex justify-between items-center"><span class="text-slate-400 font-black text-[10px] uppercase italic">التمويل المطلوب</span><span class="text-slate-900 font-black text-2xl italic tracking-tighter">$${p.funding}M</span></div>
                <div class="p-6 bg-slate-50 border border-slate-200 rounded-2xl flex justify-between items-center"><span class="text-slate-400 font-black text-[10px] uppercase italic">الموقع الجغرافي</span><span class="text-slate-900 font-black text-xl italic">${p.city}</span></div>
                <div class="p-6 bg-slate-50 border border-slate-200 rounded-2xl flex justify-between items-center"><span class="text-slate-400 font-black text-[10px] uppercase italic">نسبة المواءمة السيادية</span><span class="text-green-600 font-black text-2xl italic">${p.alignment}%</span></div>
            `;
            
            document.getElementById('admin-actions-sidebar').classList.toggle('hidden', userRole !== 'admin');
            document.getElementById('details-modal').classList.remove('hidden');
            document.getElementById('details-modal').classList.add('flex');
            lucide.createIcons();
        }

        function closeModal() { document.getElementById('details-modal').classList.add('hidden'); }
        function showAcquisitionRoom() { showNotification("جاري تفعيل بروتوكول غرفة العمليات..."); closeModal(); showPage('messages'); }
        function backToMainView() { document.getElementById('details-modal').classList.add('hidden'); }
        
        function updateStatus(status) { 
            const p = projects.find(x => x.id == currentProjectId); 
            if(p) { p.status = status; showNotification(`تم تحديث الحالة: ${status}`); closeModal(); applyFilters(); } 
        }

        function renderChatList() {
            const container = document.getElementById('chat-list');
            if(!container) return;
            container.innerHTML = projects.slice(0, 8).map(p => `
                <div onclick="openChat(${p.id})" class="p-5 bg-white border border-slate-100 rounded-2xl flex items-center gap-4 cursor-pointer hover:border-amber-500 transition-all shadow-sm">
                    <div class="w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center font-black italic text-xs uppercase">${p.name[0]}</div>
                    <div class="grow overflow-hidden text-right">
                        <p class="text-[11px] font-black truncate italic italic">${p.name}</p>
                        <p class="text-[8px] text-slate-400 font-bold italic truncate italic uppercase italic">تفاوض نشط</p>
                    </div>
                </div>
            `).join('');
        }

        function openChat(id) {
            const p = projects.find(x => x.id == id);
            document.getElementById('chat-target-name').textContent = p.name;
            const msgContainer = document.getElementById('chat-messages-container');
            msgContainer.className = "grow p-8 overflow-y-auto space-y-6 bg-slate-50/10";
            msgContainer.innerHTML = `
                <div class="flex justify-start"><div class="chat-received text-xs font-bold shadow-sm italic text-wrap-safe italic">تحية طيبة. نود مناقشة تفاصيل الاستحواذ المقترحة لكيان [${p.name}]. هل البيانات المالية محدثة؟</div></div>
                <div class="flex justify-end"><div class="chat-sent text-xs font-black shadow-lg italic text-wrap-safe italic italic">مرحباً بكم. نعم، كافة البيانات في Strategy BI محدثة لحظياً. يرجى مراجعة ملف العناية الواجبة.</div></div>
            `;
            showPage('messages');
        }

        function nextStep(s) { 
            document.querySelectorAll('[id^="form-step-"]').forEach(d => d.classList.add('hidden'));
            document.getElementById(`form-step-${s}`).classList.remove('hidden');
            document.getElementById('step-line').style.width = `${(s-1)*33.33}%`;
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function submitDiagnostics() {
            document.getElementById('loading-screen').classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('loading-screen').classList.add('hidden');
                showNotification("تم إرسال المشروع للتحليل الاستراتيجي بنجاح ✅");
                showPage('ent-dash');
                nextStep(1);
            }, 2500);
        }

        function showNotification(text) { 
            const toast = document.getElementById('notification'); 
            document.getElementById('notification-text').textContent = text; 
            toast.classList.add('show'); 
            setTimeout(() => toast.classList.remove('show'), 4000); 
        }

        window.onload = init;
    </script>
</body>
</html>
